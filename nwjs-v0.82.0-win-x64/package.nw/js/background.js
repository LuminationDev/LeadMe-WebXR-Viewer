var a0_0x5b6ae2=a0_0x424d;(function(_0x2e88ba,_0x5a3fcb){var _0x1d9547=a0_0x424d,_0x45d981=_0x2e88ba();while(!![]){try{var _0x78d8b2=parseInt(_0x1d9547(0x14a))/0x1+parseInt(_0x1d9547(0x176))/0x2*(-parseInt(_0x1d9547(0x17c))/0x3)+-parseInt(_0x1d9547(0x186))/0x4+parseInt(_0x1d9547(0x178))/0x5+-parseInt(_0x1d9547(0x15a))/0x6+-parseInt(_0x1d9547(0x140))/0x7*(-parseInt(_0x1d9547(0x157))/0x8)+-parseInt(_0x1d9547(0x189))/0x9;if(_0x78d8b2===_0x5a3fcb)break;else _0x45d981['push'](_0x45d981['shift']());}catch(_0x52c7a6){_0x45d981['push'](_0x45d981['shift']());}}}(a0_0x5250,0x5b240));var robot=require('robotjs');const fs=require('fs'),Sentry=require('@sentry/node');Sentry[a0_0x5b6ae2(0x183)]({'dsn':'https://14a93fe946924c759f2b63361110fae0@o1294571.ingest.sentry.io/4506713471516672'});function enableVrInPreferences(_0x5cb4a4=!![]){var _0x15571f=a0_0x5b6ae2,_0x47e977=(function(){var _0x2c9ce1=!![];return function(_0x8c7c2d,_0x9d570d){var _0x17b37f=_0x2c9ce1?function(){var _0x2ee7c0=a0_0x424d;if(_0x2ee7c0(0x196)!=='OUnDf'){var _0x2cfb8e=_0x471163?function(){var _0x4330f3=_0x2ee7c0;if(_0x59b6f2){var _0x2e0bf1=_0x3e475c[_0x4330f3(0x182)](_0x34f276,arguments);return _0x54184b=null,_0x2e0bf1;}}:function(){};return _0x2b40d3=![],_0x2cfb8e;}else{if(_0x9d570d){var _0x5caf14=_0x9d570d[_0x2ee7c0(0x182)](_0x8c7c2d,arguments);return _0x9d570d=null,_0x5caf14;}}}:function(){};return _0x2c9ce1=![],_0x17b37f;};}()),_0x396dfd=_0x47e977(this,function(){var _0xacfc8d=a0_0x424d;return _0x396dfd[_0xacfc8d(0x13f)]()['search'](_0xacfc8d(0x160))[_0xacfc8d(0x13f)]()['constructor'](_0x396dfd)[_0xacfc8d(0x180)](_0xacfc8d(0x160));});_0x396dfd(),console[_0x15571f(0x142)]('going\x20to\x20create');if(!fs[_0x15571f(0x16b)](process['env'][_0x15571f(0x177)]+'\x5cleadme-webxr-viewer\x5cUser\x20Data\x5cDefault\x5cPreferences')){_0x5cb4a4&&setTimeout(()=>{enableVrInPreferences(![]);},0x2710);return;}console[_0x15571f(0x142)](_0x15571f(0x159));var _0x2b7090=fs['readFileSync'](process[_0x15571f(0x171)]['LOCALAPPDATA']+_0x15571f(0x185)),_0xf69ac8=JSON[_0x15571f(0x168)](_0x2b7090);if(_0xf69ac8&&_0xf69ac8['profile']&&_0xf69ac8[_0x15571f(0x190)]['content_settings']&&_0xf69ac8[_0x15571f(0x190)]['content_settings']['exceptions']){if('vMOmx'==='ebrRv'){const _0x434600=_0x2c32b6[_0x15571f(0x13e)]();return{'x':_0x434600[_0x15571f(0x154)]+_0x382d59[_0x15571f(0x150)],'y':_0x434600[_0x15571f(0x149)]+_0x4e2646[_0x15571f(0x16d)]};}else _0xf69ac8[_0x15571f(0x190)][_0x15571f(0x18b)][_0x15571f(0x156)]['vr']={'https://edu.cospaces.io:443,*':{'last_modified':_0x15571f(0x144),'last_visit':_0x15571f(0x166),'setting':0x1},'https://immersive-web.github.io:443,*':{'last_modified':_0x15571f(0x13d),'last_visit':'17125548410000000','setting':0x1},'https://www.thinglink.com:443,*':{'last_modified':_0x15571f(0x151),'last_visit':'17125548410000000','setting':0x1}},fs[_0x15571f(0x187)](process[_0x15571f(0x171)][_0x15571f(0x177)]+'\x5cleadme-webxr-viewer\x5cUser\x20Data\x5cDefault\x5cPreferences',JSON['stringify'](_0xf69ac8));}setTimeout(()=>{enableVrInPreferences(![]);},0x2710);}try{enableVrInPreferences();}catch(a0_0x483e56){console['log'](a0_0x483e56),Sentry[a0_0x5b6ae2(0x195)](a0_0x483e56);}function a0_0x5250(){var _0x3b311a=['get','canvas','(((.+)+)+)+$','indexOf','height','end','iZLVw','eqWhf','17125548410000000','nTDfE','parse','stderr','stdout','existsSync','Start-Process\x20\x22vrmonitor://debugcommands/legacy_mirror_view_toggle\x22','scrollY','width','IiNtt','close','env','style','maximize','child_process','exit','148318IyYSvP','LOCALAPPDATA','2408625DRxCRn','$sig\x20=\x20\x27[DllImport(\x22user32.dll\x22)]\x20public\x20static\x20extern\x20bool\x20ShowWindowAsync(IntPtr\x20hWnd,\x20int\x20nCmdShow);\x27;','document','moveMouse','3YEwrEz','hostname','webvr-ui-button','innerWidth','search','display','apply','init','hide','\x5cleadme-webxr-viewer\x5cUser\x20Data\x5cDefault\x5cPreferences','767888QvPjkb','writeFileSync','data','577233QQqtRy','Get-Process\x20|\x20Where\x20{$_.MainWindowTitle\x20-eq\x20\x22Legacy\x20Mirror\x22}','content_settings','wDIxq','getElementsByTagName','powershell.exe','IvqXl','profile','innerHeight','window','html','minimize','captureException','OUnDf','immersive-web.github.io','pointer','17125548410180728','getBoundingClientRect','toString','1375283xPGhZA','mouseClick','log','rRHZL','17125548413807062','Add-Type\x20-MemberDefinition\x20$sig\x20-name\x20NativeMethods\x20-namespace\x20Win32;','constructor','length','getElementsByClassName','top','449852RqPIqM','stdin','Window','setAlwaysOnTop','spawn','qNZNN','scrollX','17125548413705202','first-continue\x20btn','wiVxo','left','mvKhw','exceptions','8ezJvot','cursor','really','2546796abhxpB','[Win32.NativeMethods]::ShowWindowAsync($handle,\x203)','location','none'];a0_0x5250=function(){return _0x3b311a;};return a0_0x5250();}function getCoordinatesOfElement(_0x4184dd){var _0x412c28=a0_0x5b6ae2;const _0x1aea05=_0x4184dd[_0x412c28(0x13e)]();return{'x':_0x1aea05[_0x412c28(0x154)]+window[_0x412c28(0x150)],'y':_0x1aea05[_0x412c28(0x149)]+window[_0x412c28(0x16d)]};}async function automationLoop(){var _0x4b5c09=a0_0x5b6ae2;let _0x753b18=nw['Window']['get']();if(_0x753b18)switch(_0x753b18['window'][_0x4b5c09(0x15c)][_0x4b5c09(0x17d)]){case'www.thinglink.com':startThinglink();return;case'edu.cospaces.io':startCospaces();return;case _0x4b5c09(0x197):webXrSampleLoop();return;default:break;}setTimeout(automationLoop,0x7d0);}function clickOnElement(_0xf4db84){var _0x42f9f6=a0_0x5b6ae2;let _0x10dfa1=nw['Window']['get']();const _0x1ccec9=getCoordinatesOfElement(_0xf4db84),_0x383ee4=_0x10dfa1[_0x42f9f6(0x16e)]-_0x10dfa1[_0x42f9f6(0x192)][_0x42f9f6(0x17f)],_0x16165e=_0x10dfa1[_0x42f9f6(0x162)]-_0x10dfa1['window'][_0x42f9f6(0x191)];robot['moveMouse'](_0x1ccec9['x']+_0x10dfa1['x']+_0x383ee4,_0x1ccec9['y']+_0x10dfa1['y']+_0x16165e),robot['mouseClick']();}function startThinglink(){var _0x59e545=a0_0x5b6ae2;let _0x440bcf=nw[_0x59e545(0x14c)]['get']();_0x440bcf[_0x59e545(0x192)][_0x59e545(0x17a)]['getElementsByTagName'](_0x59e545(0x193))[0x0][_0x59e545(0x172)][_0x59e545(0x158)]=_0x59e545(0x15d),thinglinkLoop();}async function thinglinkLoop(){var _0xde0027=a0_0x5b6ae2;let _0x2aeca1=nw['Window']['get']();var _0x3babae=_0x2aeca1[_0xde0027(0x192)][_0xde0027(0x17a)][_0xde0027(0x148)](_0xde0027(0x152));if(_0x3babae[_0xde0027(0x147)]>=0x1&&_0x3babae[0x0]['getAttribute'](_0xde0027(0x172))[_0xde0027(0x161)](_0xde0027(0x181))===-0x1){clickOnElement(_0x3babae[0x0]),setTimeout(()=>{var _0x23667e=_0xde0027;maximizeLegacyMirror(),_0x2aeca1[_0x23667e(0x14d)](![]),_0x2aeca1[_0x23667e(0x194)](),_0x2aeca1[_0x23667e(0x192)]['document'][_0x23667e(0x18d)](_0x23667e(0x193))[0x0][_0x23667e(0x172)][_0x23667e(0x158)]='';},0x3e8),_0x2aeca1['on']('close',async()=>{var _0x2f10fa=_0xde0027;nw['Window'][_0x2f10fa(0x15e)]()[_0x2f10fa(0x184)](),await closeLegacyMirror(),nw[_0x2f10fa(0x14c)][_0x2f10fa(0x15e)]()[_0x2f10fa(0x170)](!![]);});return;}setTimeout(thinglinkLoop,0x7d0);}function a0_0x424d(_0x3ab42d,_0x2f020c){var _0x14d2d6=a0_0x5250();return a0_0x424d=function(_0x3aa993,_0x1cbf94){_0x3aa993=_0x3aa993-0x13d;var _0x5250f6=_0x14d2d6[_0x3aa993];return _0x5250f6;},a0_0x424d(_0x3ab42d,_0x2f020c);}var clickedFirstCospacesButton=![],clickedSecondCospacesButton=![],clickedThirdCospacesButton=![],loopFlip=![];function startCospaces(){var _0x20a4bb=a0_0x5b6ae2;let _0x331011=nw['Window']['get']();_0x331011[_0x20a4bb(0x192)][_0x20a4bb(0x17a)][_0x20a4bb(0x18d)](_0x20a4bb(0x193))[0x0][_0x20a4bb(0x172)]['cursor']='none',setTimeout(()=>{var _0x3df167=_0x20a4bb;_0x3df167(0x18c)==='UTcWk'?_0x15de59(()=>{_0x2f77cd(![]);},0x2710):cospacesLoop();},0x3e8);}async function cospacesLoop(){var _0x40cb20=a0_0x5b6ae2;let _0x139570=nw[_0x40cb20(0x14c)][_0x40cb20(0x15e)]();const _0x58a8ec=_0x139570['x'],_0x1898b6=_0x139570['y'];loopFlip=!loopFlip;if(!clickedFirstCospacesButton){if(_0x40cb20(0x16f)!==_0x40cb20(0x143)){_0x139570[_0x40cb20(0x192)][_0x40cb20(0x17f)]>=0x318?_0x40cb20(0x153)===_0x40cb20(0x153)?robot[_0x40cb20(0x17b)](0x6c+(_0x139570['window'][_0x40cb20(0x17f)]-0x318)/0x2+0x10+_0x58a8ec+(loopFlip?0x1:0x0),_0x139570[_0x40cb20(0x192)][_0x40cb20(0x191)]*0.6+0x34+_0x1898b6):_0x1d53d7(![]):robot[_0x40cb20(0x17b)](0x20+_0x58a8ec+(loopFlip?0x1:0x0),_0x139570[_0x40cb20(0x192)][_0x40cb20(0x191)]*0.6+0x34+_0x1898b6);var _0x2ea2b9=_0x139570[_0x40cb20(0x192)][_0x40cb20(0x17a)][_0x40cb20(0x18d)](_0x40cb20(0x15f));if(_0x2ea2b9['length']>0x0){if(_0x40cb20(0x18f)!=='IvqXl'){_0x145853&&_0x4a0e91(()=>{_0x485e63(![]);},0x2710);return;}else{var _0xb90663=_0x2ea2b9[0x0];_0xb90663[_0x40cb20(0x172)][_0x40cb20(0x158)]===_0x40cb20(0x198)&&(robot[_0x40cb20(0x141)](),clickedFirstCospacesButton=!![]);}}setTimeout(cospacesLoop,0x3e8);return;}else _0x376c76['mouseClick'](),_0x39ff1f=!![];}if(!clickedSecondCospacesButton){if('Jifjw'==='Jifjw'){robot['moveMouse'](_0x58a8ec+_0x139570[_0x40cb20(0x192)][_0x40cb20(0x17f)]-0x10,_0x1898b6+_0x139570[_0x40cb20(0x192)][_0x40cb20(0x191)]-0x10),robot[_0x40cb20(0x141)](),clickedSecondCospacesButton=!![],setTimeout(cospacesLoop,0x3e8);return;}else return _0x34181e['toString']()[_0x40cb20(0x180)](_0x40cb20(0x160))[_0x40cb20(0x13f)]()[_0x40cb20(0x146)](_0x31ff5a)[_0x40cb20(0x180)](_0x40cb20(0x160));}if(!clickedThirdCospacesButton){robot[_0x40cb20(0x17b)](_0x58a8ec+_0x139570[_0x40cb20(0x192)][_0x40cb20(0x17f)]-0x3a,_0x1898b6+_0x139570[_0x40cb20(0x192)][_0x40cb20(0x191)]-0x20),robot[_0x40cb20(0x141)](),clickedThirdCospacesButton=!![],setTimeout(()=>{var _0x30b499=_0x40cb20;_0x30b499(0x14f)===_0x30b499(0x164)?(_0xf0094a(),_0x3e96f8[_0x30b499(0x14d)](![]),_0x48c9fa[_0x30b499(0x194)](),_0x366147[_0x30b499(0x192)][_0x30b499(0x17a)]['getElementsByTagName']('html')[0x0][_0x30b499(0x172)]['cursor']=''):(maximizeLegacyMirror(),_0x139570[_0x30b499(0x14d)](![]),_0x139570[_0x30b499(0x194)](),_0x139570['window'][_0x30b499(0x17a)][_0x30b499(0x18d)](_0x30b499(0x193))[0x0][_0x30b499(0x172)]['cursor']='',_0x139570['on'](_0x30b499(0x170),async()=>{var _0x6b5b9f=_0x30b499;nw[_0x6b5b9f(0x14c)][_0x6b5b9f(0x15e)]()['hide'](),await closeLegacyMirror(),nw[_0x6b5b9f(0x14c)][_0x6b5b9f(0x15e)]()[_0x6b5b9f(0x170)](!![]);}));},0x1f4);return;}}async function webXrSampleLoop(){var _0x3fc600=a0_0x5b6ae2;let _0x47295d=nw[_0x3fc600(0x14c)][_0x3fc600(0x15e)]();var _0x5ae76a=_0x47295d[_0x3fc600(0x192)]['document'][_0x3fc600(0x148)](_0x3fc600(0x17e));if(_0x5ae76a[_0x3fc600(0x147)]>=0x1){if(_0x3fc600(0x155)===_0x3fc600(0x155)){clickOnElement(_0x5ae76a[0x0]);return;}else _0xeff945();}setTimeout(webXrSampleLoop,0x3e8);}function maximizeLegacyMirror(){var _0x4ef401=a0_0x5b6ae2,_0x28502c=require(_0x4ef401(0x174))[_0x4ef401(0x14e)],_0x1e43eb,_0x4c0402=![];_0x1e43eb=_0x28502c(_0x4ef401(0x18e),[_0x4ef401(0x18a)]),_0x1e43eb[_0x4ef401(0x16a)]['on'](_0x4ef401(0x188),function(_0x57abd6){if(_0x57abd6){_0x4c0402=!![];return;}return;}),_0x1e43eb[_0x4ef401(0x169)]['on']('data',function(_0x402a6d){}),_0x1e43eb['on'](_0x4ef401(0x175),function(){var _0x378787=_0x4ef401;if('ceyNX'!=='ceyNX'){if(_0x571fae){_0x1848df=!![];return;}return;}else{if(!_0x4c0402)return;var _0x3c7b40=require('child_process')['spawn'],_0x23aeab;_0x23aeab=_0x3c7b40(_0x378787(0x18e),[_0x378787(0x179)+_0x378787(0x145)+'$handle\x20=\x20(Get-Process\x20|\x20Where\x20{$_.MainWindowTitle\x20-eq\x20\x22Legacy\x20Mirror\x22}\x20|\x20Select\x20MainWindowHandle)[0].MainWindowHandle;'+_0x378787(0x15b)]),_0x23aeab['stdout']['on'](_0x378787(0x188),function(_0x2a0baa){}),_0x23aeab[_0x378787(0x169)]['on'](_0x378787(0x188),function(_0x3d0497){}),_0x23aeab['on'](_0x378787(0x175),function(){}),_0x23aeab[_0x378787(0x14b)]['end']();}}),_0x1e43eb[_0x4ef401(0x14b)]['end']();}async function closeLegacyMirror(){var _0x3cbce1=a0_0x5b6ae2,_0x581a29=![],_0x4ae6a9=require(_0x3cbce1(0x174))['spawn'],_0x11b612;_0x11b612=_0x4ae6a9(_0x3cbce1(0x18e),[_0x3cbce1(0x18a)]),_0x11b612[_0x3cbce1(0x16a)]['on']('data',function(_0x162805){if(_0x162805){_0x581a29=!![];return;}return;}),_0x11b612[_0x3cbce1(0x169)]['on'](_0x3cbce1(0x188),function(_0x57525a){}),_0x11b612['on'](_0x3cbce1(0x175),function(){var _0x7528c7=_0x3cbce1;if(_0x7528c7(0x165)===_0x7528c7(0x167)){_0x3d747c[_0x7528c7(0x17b)](_0x298076+_0x15af78[_0x7528c7(0x192)][_0x7528c7(0x17f)]-0x10,_0x4d6217+_0x6a1466[_0x7528c7(0x192)][_0x7528c7(0x191)]-0x10),_0x2791d7['mouseClick'](),_0x2dab00=!![],_0x3ccfbd(_0x5c4160,0x3e8);return;}else{if(!_0x581a29)return;var _0x5b370=require(_0x7528c7(0x174))[_0x7528c7(0x14e)],_0x3c5454;_0x3c5454=_0x5b370('powershell.exe',[_0x7528c7(0x16c)]),_0x3c5454[_0x7528c7(0x16a)]['on'](_0x7528c7(0x188),function(_0xbf1985){}),_0x3c5454[_0x7528c7(0x169)]['on'](_0x7528c7(0x188),function(_0x239599){}),_0x3c5454['on'](_0x7528c7(0x175),function(){}),_0x3c5454['stdin'][_0x7528c7(0x163)]();}}),_0x11b612[_0x3cbce1(0x14b)][_0x3cbce1(0x163)]();}setTimeout(automationLoop,0x7d0);let win=nw[a0_0x5b6ae2(0x14c)]['get']();win[a0_0x5b6ae2(0x173)](),win['setAlwaysOnTop'](!![]);