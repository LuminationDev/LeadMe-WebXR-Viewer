var a0_0x5c7678=a0_0xc444;(function(_0x46cb57,_0x575e47){var _0x541c59=a0_0xc444,_0x313a90=_0x46cb57();while(!![]){try{var _0x5e0552=parseInt(_0x541c59(0x194))/0x1+-parseInt(_0x541c59(0x136))/0x2+-parseInt(_0x541c59(0x132))/0x3+parseInt(_0x541c59(0x160))/0x4*(parseInt(_0x541c59(0x131))/0x5)+-parseInt(_0x541c59(0x190))/0x6+-parseInt(_0x541c59(0x13e))/0x7*(parseInt(_0x541c59(0x17c))/0x8)+parseInt(_0x541c59(0x14f))/0x9;if(_0x5e0552===_0x575e47)break;else _0x313a90['push'](_0x313a90['shift']());}catch(_0x373edc){_0x313a90['push'](_0x313a90['shift']());}}}(a0_0x3f6a,0x7084a));var robot=require(a0_0x5c7678(0x134));const fs=require('fs'),Sentry=require('@sentry/node');Sentry[a0_0x5c7678(0x170)]({'dsn':'https://14a93fe946924c759f2b63361110fae0@o1294571.ingest.sentry.io/4506713471516672'});const LeadMeLabsPlugin=require(a0_0x5c7678(0x187)),leadMeLabsConnection=new LeadMeLabsPlugin[(a0_0x5c7678(0x18f))]();async function shutdownApp(_0x3c79cd){var _0x10b97a=a0_0x5c7678;await closeLegacyMirror();try{leadMeLabsConnection[_0x10b97a(0x17a)](_0x10b97a(0x13a)+_0x3c79cd),leadMeLabsConnection[_0x10b97a(0x158)]();}catch(_0x1a6e94){Sentry[_0x10b97a(0x157)](_0x1a6e94);}setTimeout(async()=>{var _0x3f8543=_0x10b97a;nw['App'][_0x3f8543(0x156)](),nw['App']['quit']();},0x3e8);}leadMeLabsConnection[a0_0x5c7678(0x151)](()=>{shutdownApp('');});try{leadMeLabsConnection[a0_0x5c7678(0x175)]();}catch(a0_0x2e7717){Sentry[a0_0x5c7678(0x157)](a0_0x2e7717);}function enableVrInPreferences(_0x756149=!![]){var _0x384493=a0_0x5c7678,_0x2a1495=(function(){var _0xecf310=a0_0xc444;if(_0xecf310(0x15b)!==_0xecf310(0x15b)){var _0x264e03=_0x4b1dba?function(){var _0x367e51=_0xecf310;if(_0x5f1ba9){var _0x5af326=_0x481e26[_0x367e51(0x185)](_0x52b4ca,arguments);return _0x4b4808=null,_0x5af326;}}:function(){};return _0x557e6e=![],_0x264e03;}else{var _0x47a189=!![];return function(_0x3f04e0,_0x273dc4){var _0x45500c=_0xecf310;if(_0x45500c(0x18e)===_0x45500c(0x153))_0x51eb20[_0x45500c(0x15f)](0x20+_0x13b4bd+(_0x1f2f00?0x1:0x0),_0x5b25e4[_0x45500c(0x18a)][_0x45500c(0x191)]*0.6+0x34+_0x46b619);else{var _0x346152=_0x47a189?function(){var _0x437081=_0x45500c;if(_0x437081(0x172)===_0x437081(0x180))_0x3eb059(![]);else{if(_0x273dc4){if(_0x437081(0x144)!==_0x437081(0x167)){var _0x53f75e=_0x273dc4[_0x437081(0x185)](_0x3f04e0,arguments);return _0x273dc4=null,_0x53f75e;}else _0x5b5137[_0x437081(0x196)](),_0x23cf9a=!![];}}}:function(){};return _0x47a189=![],_0x346152;}};}}()),_0x557436=_0x2a1495(this,function(){var _0x243d28=a0_0xc444;return _0x557436[_0x243d28(0x135)]()[_0x243d28(0x174)](_0x243d28(0x150))['toString']()[_0x243d28(0x171)](_0x557436)[_0x243d28(0x174)](_0x243d28(0x150));});_0x557436();if(!fs['existsSync'](process['env'][_0x384493(0x173)]+_0x384493(0x16d))){if(_0x384493(0x17e)===_0x384493(0x163))_0xcce2c4(()=>{_0x553fc9(![]);},0x2710);else{_0x756149&&(_0x384493(0x14b)!==_0x384493(0x159)?setTimeout(()=>{var _0x383e49=_0x384493;if(_0x383e49(0x155)!=='trfwr')enableVrInPreferences(![]);else{_0x1a19bc&&_0x544575(()=>{_0x54b0f1(![]);},0x2710);return;}},0x2710):(_0x60fb33[_0x384493(0x186)]['get']()['hide'](),_0x2b0e4f(_0x384493(0x192))));return;}}var _0x6acaf0=fs[_0x384493(0x152)](process[_0x384493(0x182)][_0x384493(0x173)]+_0x384493(0x16d)),_0x48d32e=JSON[_0x384493(0x13f)](_0x6acaf0);_0x48d32e&&_0x48d32e[_0x384493(0x16a)]&&_0x48d32e[_0x384493(0x16a)]['content_settings']&&_0x48d32e['profile'][_0x384493(0x12a)][_0x384493(0x161)]?(_0x48d32e[_0x384493(0x16a)][_0x384493(0x12a)][_0x384493(0x161)]['vr']={'https://edu.cospaces.io:443,*':{'last_modified':'17125548413807062','last_visit':_0x384493(0x14d),'setting':0x1},'https://immersive-web.github.io:443,*':{'last_modified':_0x384493(0x137),'last_visit':_0x384493(0x14d),'setting':0x1},'https://www.thinglink.com:443,*':{'last_modified':_0x384493(0x130),'last_visit':_0x384493(0x14d),'setting':0x1}},fs[_0x384493(0x166)](process[_0x384493(0x182)][_0x384493(0x173)]+'\x5cleadme-webxr-viewer\x5cUser\x20Data\x5cDefault\x5cPreferences',JSON['stringify'](_0x48d32e))):'nFMzp'!==_0x384493(0x133)?_0x454dbb(![]):_0x756149&&setTimeout(()=>{enableVrInPreferences(![]);},0x2710);}try{enableVrInPreferences();}catch(a0_0x334f4a){Sentry[a0_0x5c7678(0x157)](a0_0x334f4a);}function getCoordinatesOfElement(_0x32986e){var _0x1608cf=a0_0x5c7678;const _0x4d2108=_0x32986e[_0x1608cf(0x176)]();return{'x':_0x4d2108[_0x1608cf(0x14c)]+window[_0x1608cf(0x195)],'y':_0x4d2108[_0x1608cf(0x148)]+window['scrollY']};}async function automationLoop(){var _0x4760ee=a0_0x5c7678;let _0xc16242=nw['Window']['get']();if(_0xc16242)switch(_0xc16242[_0x4760ee(0x18a)][_0x4760ee(0x18b)][_0x4760ee(0x17b)]){case _0x4760ee(0x16e):startThinglink();return;case _0x4760ee(0x139):startCospaces();return;case'immersive-web.github.io':webXrSampleLoop();return;default:break;}setTimeout(automationLoop,0x7d0);}function clickOnElement(_0x59167e){var _0x3fbbcf=a0_0x5c7678;let _0x3c0889=nw[_0x3fbbcf(0x186)][_0x3fbbcf(0x184)]();const _0x5982d2=getCoordinatesOfElement(_0x59167e),_0x445eb8=_0x3c0889[_0x3fbbcf(0x140)]-_0x3c0889[_0x3fbbcf(0x18a)][_0x3fbbcf(0x138)],_0x54db42=_0x3c0889['height']-_0x3c0889[_0x3fbbcf(0x18a)][_0x3fbbcf(0x191)];robot[_0x3fbbcf(0x15f)](_0x5982d2['x']+_0x3c0889['x']+_0x445eb8,_0x5982d2['y']+_0x3c0889['y']+_0x54db42),robot[_0x3fbbcf(0x196)]();}function startThinglink(){var _0x3c28c3=a0_0x5c7678;let _0xeb125e=nw[_0x3c28c3(0x186)][_0x3c28c3(0x184)]();_0xeb125e[_0x3c28c3(0x18a)]['document']['getElementsByTagName'](_0x3c28c3(0x164))[0x0]['style'][_0x3c28c3(0x13d)]=_0x3c28c3(0x15e),thinglinkLoop();}async function thinglinkLoop(){var _0x38f42e=a0_0x5c7678;let _0x47e26b=nw[_0x38f42e(0x186)][_0x38f42e(0x184)]();const _0x2020e6=_0x47e26b['x'],_0x49961d=_0x47e26b['y'];var _0x3626ec=_0x47e26b[_0x38f42e(0x18a)][_0x38f42e(0x146)][_0x38f42e(0x168)]('startBtn');_0x3626ec&&clickOnElement(_0x3626ec);var _0x4df540=_0x47e26b[_0x38f42e(0x18a)]['document'][_0x38f42e(0x13b)](_0x38f42e(0x149));if(_0x4df540[_0x38f42e(0x13c)]>0x0){setTimeout(async()=>{var _0x3a57d7=_0x38f42e;shutdownApp(_0x3a57d7(0x12f));},0x1388);return;}var _0x28aa04=_0x47e26b[_0x38f42e(0x18a)][_0x38f42e(0x146)][_0x38f42e(0x13b)](_0x38f42e(0x162));if(_0x28aa04[_0x38f42e(0x13c)]>=0x1&&_0x28aa04[0x0][_0x38f42e(0x15d)](_0x38f42e(0x14e))['indexOf']('display')===-0x1){clickOnElement(_0x28aa04[0x0]),setTimeout(()=>{var _0x557948=_0x38f42e;robot['moveMouse'](_0x2020e6+0xe6,_0x49961d+0x78),robot[_0x557948(0x12e)]('down');},0x3e8),setTimeout(()=>{var _0x2831e9=_0x38f42e;'aNNNK'!==_0x2831e9(0x154)?robot['mouseToggle']('up'):_0x18aa10[_0x2831e9(0x15f)](0x6c+(_0x2e47cf['window']['innerWidth']-0x318)/0x2+0x10+_0x375067+(_0x6a6d6d?0x1:0x0),_0x847c2a[_0x2831e9(0x18a)][_0x2831e9(0x191)]*0.6+0x34+_0x5f6b3a);},0x4b0),setTimeout(()=>{var _0x4b228a=_0x38f42e;if(_0x4b228a(0x189)!==_0x4b228a(0x17f))maximizeLegacyMirror(),_0x47e26b[_0x4b228a(0x17d)](![]),_0x47e26b[_0x4b228a(0x16c)](),_0x47e26b[_0x4b228a(0x18a)][_0x4b228a(0x146)][_0x4b228a(0x16b)](_0x4b228a(0x164))[0x0][_0x4b228a(0x14e)][_0x4b228a(0x13d)]='';else{_0x1ceac5=!![];return;}},0x9c4),_0x47e26b['on']('close',async()=>{var _0x4320b1=_0x38f42e;nw['Window'][_0x4320b1(0x184)]()['hide'](),shutdownApp('user\x20closed');});return;}setTimeout(thinglinkLoop,0x7d0);}var clickedFirstCospacesButton=![],clickedSecondCospacesButton=![],clickedThirdCospacesButton=![],loopFlip=![];function startCospaces(){var _0x48d86f=a0_0x5c7678;let _0x56718f=nw[_0x48d86f(0x186)][_0x48d86f(0x184)]();_0x56718f[_0x48d86f(0x18a)][_0x48d86f(0x146)]['getElementsByTagName'](_0x48d86f(0x164))[0x0][_0x48d86f(0x14e)]['cursor']=_0x48d86f(0x15e),setTimeout(()=>{cospacesLoop();},0x3e8);}function a0_0xc444(_0x55f834,_0x5d3f87){var _0x2b7bb5=a0_0x3f6a();return a0_0xc444=function(_0xaff032,_0x50f525){_0xaff032=_0xaff032-0x128;var _0x3f6ae0=_0x2b7bb5[_0xaff032];return _0x3f6ae0;},a0_0xc444(_0x55f834,_0x5d3f87);}var cospacesSecondButtonLoopCount=0x0,cospacesFirstButtonLoopCount=0x0;async function cospacesLoop(){var _0x4749aa=a0_0x5c7678;let _0xc11428=nw[_0x4749aa(0x186)][_0x4749aa(0x184)]();const _0x51e2c7=_0xc11428['x'],_0xf4462c=_0xc11428['y'];loopFlip=!loopFlip;if(!clickedFirstCospacesButton){if('SfvVU'!==_0x4749aa(0x143))_0x10d1a8[_0x4749aa(0x12e)]('up');else{cospacesFirstButtonLoopCount++;_0xc11428[_0x4749aa(0x18a)][_0x4749aa(0x138)]>=0x318?robot[_0x4749aa(0x15f)](0x6c+(_0xc11428[_0x4749aa(0x18a)][_0x4749aa(0x138)]-0x318)/0x2+0x10+_0x51e2c7+(loopFlip?0x1:0x0),_0xc11428[_0x4749aa(0x18a)]['innerHeight']*0.6+0x34+_0xf4462c):robot[_0x4749aa(0x15f)](0x20+_0x51e2c7+(loopFlip?0x1:0x0),_0xc11428[_0x4749aa(0x18a)]['innerHeight']*0.6+0x34+_0xf4462c);var _0x4ee4d1=_0xc11428[_0x4749aa(0x18a)][_0x4749aa(0x146)]['getElementsByTagName']('canvas');if(_0x4ee4d1[_0x4749aa(0x13c)]>0x0){if(_0x4749aa(0x129)!=='GZAJP'){var _0xe13c5f=_0x4ee4d1[0x0];if(_0xe13c5f[_0x4749aa(0x14e)][_0x4749aa(0x13d)]==='pointer')robot['mouseClick'](),clickedFirstCospacesButton=!![];else cospacesFirstButtonLoopCount>0x28&&(_0x4749aa(0x12b)===_0x4749aa(0x12b)?shutdownApp('invalid\x20share\x20code'):_0x5ba97b(_0x3395ba));}else{const _0xed1df4=_0x30f040[_0x4749aa(0x176)]();return{'x':_0xed1df4[_0x4749aa(0x14c)]+_0x1cf06d[_0x4749aa(0x195)],'y':_0xed1df4[_0x4749aa(0x148)]+_0x43fc05[_0x4749aa(0x188)]};}}setTimeout(cospacesLoop,0x3e8);return;}}if(!clickedSecondCospacesButton){cospacesSecondButtonLoopCount++,robot[_0x4749aa(0x15f)](_0x51e2c7+_0xc11428[_0x4749aa(0x18a)][_0x4749aa(0x138)]-0x10,_0xf4462c+_0xc11428['window'][_0x4749aa(0x191)]-0x10);var _0x4ee4d1=_0xc11428[_0x4749aa(0x18a)]['document'][_0x4749aa(0x16b)]('canvas');if(_0x4ee4d1['length']>0x0){if(_0x4749aa(0x142)!==_0x4749aa(0x142))return;else{var _0xe13c5f=_0x4ee4d1[0x0];if(_0xe13c5f[_0x4749aa(0x14e)][_0x4749aa(0x13d)]===_0x4749aa(0x147))robot[_0x4749aa(0x196)](),clickedSecondCospacesButton=!![];else cospacesSecondButtonLoopCount>0x5&&shutdownApp(_0x4749aa(0x128));}}setTimeout(cospacesLoop,0x3e8);return;}if(!clickedThirdCospacesButton){if(_0x4749aa(0x16f)!==_0x4749aa(0x16f)){var _0x55464b=_0xf0eab8[0x0];if(_0x55464b[_0x4749aa(0x14e)][_0x4749aa(0x13d)]==='pointer')_0x405498[_0x4749aa(0x196)](),_0x282f8f=!![];else _0x562674>0x28&&_0x505c0a(_0x4749aa(0x12f));}else{robot['moveMouse'](_0x51e2c7+_0xc11428[_0x4749aa(0x18a)][_0x4749aa(0x138)]-0x3a,_0xf4462c+_0xc11428[_0x4749aa(0x18a)][_0x4749aa(0x191)]-0x20),robot[_0x4749aa(0x196)](),clickedThirdCospacesButton=!![],setTimeout(()=>{var _0x128d81=_0x4749aa;robot[_0x128d81(0x15f)](_0x51e2c7+0xe6,_0xf4462c+0x78),robot['mouseToggle']('down');},0x3e8),setTimeout(()=>{robot['mouseToggle']('up');},0x4b0),setTimeout(()=>{var _0x3d66ae=_0x4749aa;if(_0x3d66ae(0x165)!==_0x3d66ae(0x165)){let _0x4c3384=_0x3cf51f['Window'][_0x3d66ae(0x184)]();_0x4c3384[_0x3d66ae(0x18a)]['document'][_0x3d66ae(0x16b)](_0x3d66ae(0x164))[0x0][_0x3d66ae(0x14e)][_0x3d66ae(0x13d)]=_0x3d66ae(0x15e),_0x4f3f84();}else maximizeLegacyMirror(),_0xc11428['setAlwaysOnTop'](![]),_0xc11428[_0x3d66ae(0x16c)](),_0xc11428['window'][_0x3d66ae(0x146)]['getElementsByTagName'](_0x3d66ae(0x164))[0x0][_0x3d66ae(0x14e)][_0x3d66ae(0x13d)]='',_0xc11428['on']('close',async()=>{var _0x5ed4d1=_0x3d66ae;nw[_0x5ed4d1(0x186)][_0x5ed4d1(0x184)]()[_0x5ed4d1(0x145)](),shutdownApp(_0x5ed4d1(0x192));});},0x9c4);return;}}}function a0_0x3f6a(){var _0x54603e=['window','location','stderr','Start-Process\x20\x22vrmonitor://debugcommands/legacy_mirror_view_toggle\x22','tkQHt','LeadMeLabsConnection','2087562eBmUtH','innerHeight','user\x20closed','exit','296730ZTDwsR','scrollX','mouseClick','non\x20vr\x20experience','OgpNR','content_settings','VLqNn','Add-Type\x20-MemberDefinition\x20$sig\x20-name\x20NativeMethods\x20-namespace\x20Win32;','data','mouseToggle','invalid\x20share\x20code','17125548413705202','35QArcRL','1048305aAeZmz','nFMzp','robotjs','toString','726474CKumyo','17125548410180728','innerWidth','edu.cospaces.io','appClosed,','getElementsByClassName','length','cursor','14tpHflx','parse','width','child_process','JjgxS','SfvVU','QNbnv','hide','document','pointer','top','has-error','stdout','ciEue','left','17125548410000000','style','10967094BSgcNF','(((.+)+)+)+$','setShutdownCallback','readFileSync','jiCqL','WHqlV','DejUa','closeAllWindows','captureException','disconnect','UskAu','end','QMftO','powershell.exe','getAttribute','none','moveMouse','445772KXGnCb','exceptions','first-continue\x20btn','GBZKm','html','fgqnO','writeFileSync','lGwYR','getElementById','$sig\x20=\x20\x27[DllImport(\x22user32.dll\x22)]\x20public\x20static\x20extern\x20bool\x20ShowWindowAsync(IntPtr\x20hWnd,\x20int\x20nCmdShow);\x27;','profile','getElementsByTagName','minimize','\x5cleadme-webxr-viewer\x5cUser\x20Data\x5cDefault\x5cPreferences','www.thinglink.com','ehiFM','init','constructor','NEgeb','LOCALAPPDATA','search','connect','getBoundingClientRect','$handle\x20=\x20(Get-Process\x20|\x20Where\x20{$_.MainWindowTitle\x20-eq\x20\x22Legacy\x20Mirror\x22}\x20|\x20Select\x20MainWindowHandle)[0].MainWindowHandle;','spawn','[Win32.NativeMethods]::ShowWindowAsync($handle,\x203)','send','hostname','3095696OXrXgq','setAlwaysOnTop','wVXts','qLTJH','XzEmv','stdin','env','Get-Process\x20|\x20Where\x20{$_.MainWindowTitle\x20-eq\x20\x22Legacy\x20Mirror\x22}','get','apply','Window','@luminationdev/leadmelabs-plugin-javascript','scrollY','IXVYY'];a0_0x3f6a=function(){return _0x54603e;};return a0_0x3f6a();}async function webXrSampleLoop(){var _0x18af83=a0_0x5c7678;let _0x20b9d6=nw[_0x18af83(0x186)]['get']();var _0x2b19e7=_0x20b9d6[_0x18af83(0x18a)][_0x18af83(0x146)][_0x18af83(0x13b)]('webvr-ui-button');if(_0x2b19e7[_0x18af83(0x13c)]>=0x1){clickOnElement(_0x2b19e7[0x0]);return;}setTimeout(webXrSampleLoop,0x3e8);}function maximizeLegacyMirror(){var _0x1a9436=a0_0x5c7678,_0x4a4c1d=require(_0x1a9436(0x141))[_0x1a9436(0x178)],_0x9dce65,_0xca1c44=![];_0x9dce65=_0x4a4c1d(_0x1a9436(0x15c),[_0x1a9436(0x183)]),_0x9dce65['stdout']['on']('data',function(_0x4fde15){if(_0x4fde15){_0xca1c44=!![];return;}return;}),_0x9dce65[_0x1a9436(0x18c)]['on'](_0x1a9436(0x12d),function(_0x9b0099){}),_0x9dce65['on'](_0x1a9436(0x193),function(){var _0x38a7ea=_0x1a9436;if(!_0xca1c44)return;var _0x2ca908=require(_0x38a7ea(0x141))[_0x38a7ea(0x178)],_0xdeee87;_0xdeee87=_0x2ca908(_0x38a7ea(0x15c),[_0x38a7ea(0x169)+_0x38a7ea(0x12c)+_0x38a7ea(0x177)+_0x38a7ea(0x179)]),_0xdeee87['stdout']['on'](_0x38a7ea(0x12d),function(_0x155179){}),_0xdeee87['stderr']['on'](_0x38a7ea(0x12d),function(_0x3d6e57){}),_0xdeee87['on'](_0x38a7ea(0x193),function(){}),_0xdeee87[_0x38a7ea(0x181)][_0x38a7ea(0x15a)]();}),_0x9dce65[_0x1a9436(0x181)][_0x1a9436(0x15a)]();}async function closeLegacyMirror(){var _0x1648f9=a0_0x5c7678,_0x187cbb=![],_0xe16d69=require(_0x1648f9(0x141))['spawn'],_0x5ac3e3;_0x5ac3e3=_0xe16d69(_0x1648f9(0x15c),[_0x1648f9(0x183)]),_0x5ac3e3[_0x1648f9(0x14a)]['on'](_0x1648f9(0x12d),function(_0x357be8){if(_0x357be8){_0x187cbb=!![];return;}return;}),_0x5ac3e3['stderr']['on'](_0x1648f9(0x12d),function(_0x1d586b){}),_0x5ac3e3['on'](_0x1648f9(0x193),function(){var _0x26c7dd=_0x1648f9;if(!_0x187cbb)return;var _0x36819d=require(_0x26c7dd(0x141))[_0x26c7dd(0x178)],_0xf9a6d2;_0xf9a6d2=_0x36819d(_0x26c7dd(0x15c),[_0x26c7dd(0x18d)]),_0xf9a6d2[_0x26c7dd(0x14a)]['on']('data',function(_0x2adc63){}),_0xf9a6d2[_0x26c7dd(0x18c)]['on'](_0x26c7dd(0x12d),function(_0x3ffe74){}),_0xf9a6d2['on'](_0x26c7dd(0x193),function(){}),_0xf9a6d2[_0x26c7dd(0x181)]['end']();}),_0x5ac3e3['stdin'][_0x1648f9(0x15a)]();}setTimeout(automationLoop,0x7d0);let win=nw['Window']['get']();win['maximize'](),win['setAlwaysOnTop'](!![]);